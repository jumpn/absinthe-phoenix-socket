# @jumpn/absinthe-phoenix-subscriber

> Absinthe Phoenix Subscriber

## Types

```flowtype
type SubscriptionObserver<Value> = {
  onAbort: (error: Error) => any,
  onError: (error: Error) => any,
  onOpen: (subscription: Subscription<Value>) => any,
  onValue: (value: Value) => any
};

type SubscriptionMessage = {
  query: string,
  variables?: Object
};

type Subscription<Value> = {
  message: SubscriptionMessage,
  observers: Array<SubscriptionObserver<Value>>,
  id?: string
};

type ObservationLink<Value> = {
  isObserving: () => boolean,
  unobserve: () => Promise<Subscription<Value>>
};

type AbsintheSubscriber = {
  channel: Channel,
  isJoining: boolean,
  phoenixClient: PhoenixClient,
  subscriptions: Array<Subscription<any>>
};
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### observe

Links observer to subscription

**Parameters**

-   `subscriber` **AbsintheSubscriber** 
-   `subscription` **Subscription&lt;Value>** 
-   `observer` **SubscriptionObserver&lt;Value>** 

**Examples**

```javascript
import Subscriber from "@jumpn/absinthe-phoenix-subscriber"

const logEvent = eventName => (...args) => console.log(eventName, ...args);

const observationLink = Subscriber.observe(subcriber, subscription, {
  onAbort: logEvent("abort"),
  onError: logEvent("error"),
  onOpen: logEvent("open"),
  onValue: logEvent("next")
});
```

Returns **ObservationLink&lt;$Subtype&lt;Value>>** 

### subscribe

Creates a subscription to the given message

**Parameters**

-   `subscriber` **AbsintheSubscriber** 
-   `message` **SubscriptionMessage** 

**Examples**

```javascript
import Subscriber from "@jumpn/absinthe-phoenix-subscriber";

const query = `
  subscription userSubscription($userId: ID!) {
    user(userId: $userId) {
      id
      name
    }
  }
`;

const subscription = Subscriber.subscribe(subscriber, {
  query,
  variables: {userId: 10}
});
```

Returns **Subscription&lt;any>** 

### create

Creates a subscriber using the given PhoenixClient instance

**Parameters**

-   `phoenixClient` **PhoenixClient** 

**Examples**

```javascript
import Subscriber from "@jumpn/absinthe-phoenix-subscriber";
import {Socket as PhoenixClient} from "phoenix";

const subscriber = Subscriber.create(
  new PhoenixClient("ws://localhost:4000/socket")
);
```

Returns **AbsintheSubscriber** 

## License

[MIT](LICENSE.txt) :copyright: **Jumpn Limited** / Mauro Titimoli (mauro@jumpn.com)
